for  preprocess 
main_preprocess.py
for main run
MLTA_retina_Main.py

Efficientnet model Backbone

https://storage.googleapis.com/keras-applications/efficientnetb7_notop.h5

Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 300, 300,  │          0 │ -                 │
│ (InputLayer)        │ 3)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ rescaling           │ (None, 300, 300,  │          0 │ input_layer[0][0] │
│ (Rescaling)         │ 3)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multi_level_featur… │ [(None, 150, 150, │ 64,097,687 │ rescaling[0][0]   │
│ (MultiLevelFeature… │ 192), (None, 38,  │            │                   │
│                     │ 38, 480), (None,  │            │                   │
│                     │ 19, 19, 1344),    │            │                   │
│                     │ (None, 10, 10,    │            │                   │
│                     │ 2560)]            │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_average_poo… │ (None, 192)       │          0 │ multi_level_feat… │
│ (GlobalAveragePool… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_average_poo… │ (None, 480)       │          0 │ multi_level_feat… │
│ (GlobalAveragePool… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_average_poo… │ (None, 1344)      │          0 │ multi_level_feat… │
│ (GlobalAveragePool… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_average_poo… │ (None, 2560)      │          0 │ multi_level_feat… │
│ (GlobalAveragePool… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense (Dense)       │ (None, 256)       │     49,408 │ global_average_p… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_2 (Dense)     │ (None, 256)       │    123,136 │ global_average_p… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_4 (Dense)     │ (None, 256)       │    344,320 │ global_average_p… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_6 (Dense)     │ (None, 256)       │    655,616 │ global_average_p… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ reshape (Reshape)   │ (None, 1, 256)    │          0 │ dense[0][0]       │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ reshape_1 (Reshape) │ (None, 1, 256)    │          0 │ dense_2[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ reshape_2 (Reshape) │ (None, 1, 256)    │          0 │ dense_4[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ reshape_3 (Reshape) │ (None, 1, 256)    │          0 │ dense_6[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ throttled_attention │ (None, 1, 256)    │    263,425 │ reshape[0][0]     │
│ (ThrottledAttentio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ throttled_attentio… │ (None, 1, 256)    │    263,425 │ reshape_1[0][0]   │
│ (ThrottledAttentio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ throttled_attentio… │ (None, 1, 256)    │    263,425 │ reshape_2[0][0]   │
│ (ThrottledAttentio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ throttled_attentio… │ (None, 1, 256)    │    263,425 │ reshape_3[0][0]   │
│ (ThrottledAttentio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 4, 256)    │          0 │ throttled_attent… │
│ (Concatenate)       │                   │            │ throttled_attent… │
│                     │                   │            │ throttled_attent… │
│                     │                   │            │ throttled_attent… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ positional_encoding │ (None, 4, 256)    │          0 │ concatenate[0][0] │
│ (PositionalEncodin… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ vision_transformer… │ (None, 4, 256)    │    527,361 │ positional_encod… │
│ (VisionTransformer… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ vision_transformer… │ (None, 4, 256)    │    527,361 │ vision_transform… │
│ (VisionTransformer… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ vision_transformer… │ (None, 4, 256)    │    527,361 │ vision_transform… │
│ (VisionTransformer… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ vision_transformer… │ (None, 4, 256)    │    527,361 │ vision_transform… │
│ (VisionTransformer… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ vision_transformer… │ (None, 4, 256)    │    527,361 │ vision_transform… │
│ (VisionTransformer… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ efficientnetb7      │ (None, 10, 10,    │ 64,097,687 │ input_layer[0][0] │
│ (Functional)        │ 2560)             │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ vision_transformer… │ (None, 4, 256)    │    527,361 │ vision_transform… │
│ (VisionTransformer… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_average_poo… │ (None, 2560)      │          0 │ efficientnetb7[0… │
│ (GlobalAveragePool… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_average_poo… │ (None, 256)       │          0 │ vision_transform… │
│ (GlobalAveragePool… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_26 (Dense)    │ (None, 256)       │    655,616 │ global_average_p… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 512)       │          0 │ global_average_p… │
│ (Concatenate)       │                   │            │ dense_26[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_27 (Dense)    │ (None, 512)       │    262,656 │ concatenate_1[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_22          │ (None, 512)       │          0 │ dense_27[0][0]    │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_28 (Dense)    │ (None, 256)       │    131,328 │ dropout_22[0][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_23          │ (None, 256)       │          0 │ dense_28[0][0]    │
│ (Dropout)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_29 (Dense)    │ (None, 4)         │      1,028 │ dropout_23[0][0]  │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
